# 自動会計システム 設計書

## 1. プロジェクト概要

### 1.1. プロジェクト名
自動会計システム

### 1.2. 目的
琉大祭の模擬店における会計業務を、画像認識技術を用いて自動化・効率化することを目的とします。

### 1.3. 特徴
- **高速な会計**: カメラで商品を写すだけで、品目と個数を自動で判定します。
- **簡単な操作**: 直感的なUIで、誰でも簡単に操作可能です。
- **柔軟な商品管理**: 商品の画像や価格を簡単に追加・編集できます。

---

## 2. システム設計

### 2.1. システム構成
本システムは、ユーザーが操作する**フロントエンド**と、画像認識および計算処理を行う**バックエンド**で構成されます。

- **フロントエンド (Next.js)**:
    - ユーザーインターフェースの提供
    - 商品撮影用のカメラインターフェース
    - バックエンドへの画像データ送信
    - 会計結果の表示
- **バックエンド (Python)**:
    - 受け取った画像データの解析（画像認識）
    - 商品の種類と個数の特定
    - 商品データベースとの照合
    - 合計金額の計算とフロントエンドへの返却

### 2.2. 開発環境・使用技術
| カテゴリ | 使用技術・ツール |
| :--- | :--- |
| **フロントエンド** | Next.js (React) |
| **バックエンド** | Python 3 |
| **開発ツール** | Visual Studio Code |
| **バージョン管理** | Git / GitHub |

---

## 3. ファイル構造
```
auto_accounting/
├── backend/                        # Pythonバックエンドの全コード
│   ├── api/                        # メインのアプリケーションコード
│   │   ├── __init__.py             # apiのパッケージ化
│   │   ├── app.py                  # APIサーバー本体 (Flask/FastAPI)
│   │   ├── image_segmenter.py      # 画像切り出し
│   │   └── classifier.py           # TensorFlowでの識別
│   │
│   ├── models/                     # 学習済みモデルを保存する場所
│   │   └── product_classifier.h5
│   │
│   ├── requirements.txt            # Pythonのライブラリリスト (pip install -r)
│   └── .gitignore
│
└── frontend/                       # Next.jsフロントエンドの全コード
    ├── app/
    │   ├── page.tsx                # 画像アップロード画面
    │   └── result/
    │       └── page.tsx            # 結果表示画面
    │
    ├── public/
    │   └── imgs/
    │
    ├── package.json
    └── .gitignore
```

---

## 4. 機能設計

### 4.1. 機能一覧
| 優先度 | 機能名 | 概要 |
| :--- | :--- | :--- |
| 1 | **画像認識・会計機能** | 撮影された画像から商品の種類と個数を判定し、合計金額を計算・表示する。 |
| 2 | **商品・画像登録機能** | 会計対象となる商品の画像、名前、価格をシステムに登録・管理する。 |

### 4.2. 基本設計
| 機能名 | 入力 | 出力 | 前提条件 | 事後条件 |
| :--- | :--- | :--- | :--- | :--- |
| **画像認識** | 購入品を撮影した画像 | 商品の種類、個数 | ・商品は登録済みである<br>・画像形式はPNG/JPEG | 認識結果が内部で保持される |
| **画像登録** | 商品のPNG/JPEG画像 | 登録成功/失敗メッセージ | 画像がNULLでない | 画像が商品情報と紐づいてDBに保存される |
| **金額計算** | 商品の種類、個数 | 合計金額 | 商品マスタに価格が登録されている | 計算された合計金額が保持される |
| **合計金額表示**| (内部データ) | 合計金額 | 金額計算が完了している | 画面に合計金額が表示される |

---

## 5. 開発について

### 5.1. バージョン管理
- **リポジトリ**: GitHub上で管理します。
- **ブランチ戦略**: `main`ブランチを本番用、`feature`ブランチを開発用として切って作業を進めます。

### 5.2. タスク
| 優先度 | タスク              | 概要                                    |　担当者  |
| :---- | :----------------- | :------------------------------------- | :------ |
| 1     | モデル作成           | 仮の商品でモデル作成を実践検証              | しょー   |
| 1     | フロントエンド作成    | クライアントサイドの画面を作成               | りょうた |
| 2     | 推論の実行           | 写真に写っている画像がなんの商品であるのか推測 | しょー   |
| 2     | 画像の読み込みと二値化 | クライアント画面から獲得した画像を読み込み二値化 | りょうた |
| 3     | 合計計算             | 商品の合計金額を算出する                    | しょー  |
| 3     | 輪郭の検出と切り出し   | 二値化した値から輪郭座標を獲得し元画像を切り取る | りょうた |
